!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define("jfortune",["react"],e):"object"==typeof exports?exports.jfortune=e(require("react")):t.jfortune=e(t.react)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,i){"use strict";function n(t){var e=[[Math.cos(t),Math.sin(t),0,0],[Math.sin(-t),Math.cos(t),0,0],[0,0,1,0],[0,0,0,1]],i=function(t,e,i){return t+(i>0?",":"")+e.join(",")};return e.reduce(i,"")}function r(t){var e="matrix3d("+t+")";return{transform:e,WebkitTransform:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.matrix3dRotateZ=n,e.createTransformFromMatrix3d=r},function(t,e,i){"use strict";function n(t,e){var i=e-t,n=i+1;return Math.floor(Math.random()*n)+t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=400,r=function(t){return 1/(200*t)},o=function(t,e,i,o){var s=3*t,a=3*(i-t)-s,u=1-s-a,c=3*e,p=3*(o-e)-c,f=1-c-p,l=function(t){return((u*t+a)*t+s)*t},h=function(t){return((f*t+p)*t+c)*t},d=function(t){return(3*u*t+2*a)*t+s},m=function(t,e){var i,n,r,o,s,a;for(r=t,a=0;a<8;a++){if(o=l(r)-t,Math.abs(o)<e)return r;if(s=d(r),Math.abs(s)<1e-6)break;r-=o/s}if(i=0,n=1,r=t,r<i)return i;if(r>n)return n;for(;i<n;){if(o=l(r),Math.abs(o-t)<e)return r;t>o?i=r:n=r,r=.5*(n-i)+i}return r},y=function(t,e){return h(m(t,e))};return function(t,e){return y(t,r(+e||n))}};e.default={linear:o(0,0,1,1),ease:o(.25,.1,.25,1),easeIn:o(.42,0,1,1),easeOut:o(0,0,.58,1),easeInOut:o(.42,0,.58,1),cubicBezier:function(t,e,i,n,r,s){return o(t,e,i,n)(r,s)}}},function(e,i){e.exports=t},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.JFortuneDirection=e.default=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(3),c=n(u),p=i(2),f=n(p),l=i(1),h=n(l),d=i(0),m=function(t){throw Error(t+" must be defined!")},y=Object.freeze({__proto__:null,CLOCKWISE:1,COUNTER_CLOCKWISE:-1}),b={directionMultiplier:function(){return this.direction===y.COUNTER_CLOCKWISE?-1:1},needsBounce:function(){var t=this.state,e=t.gap,i=t.options,n=.5*e,r=Math.abs((n+this.angle)%e),o=Math.abs(this.angle-this.prev_angle),s=.5*i.separatorThickness,a=e-s;return o>=n?1:r<s||r>a?2:0},rotate:function(t,e){this.direction=e,this.angle=t,this.doRotate(t);var i=b.needsBounce.call(this);i?(1!==i&&this.state.isBouncing||this.state.options.onSpinBounce(this),this.doSpinnerBounce(b.directionMultiplier.call(this))):this.stopSpinnerBounce(),this.prev_angle=this.angle},forceEnd:function(){var t=this.state.options;this.spin_frame&&cancelAnimationFrame(this.spin_frame),b.rotate.call(this,this.stop,this.direction),this.stopSpinnerBounce(),this.deferred&&this.fulfilled(Array.isArray(t.prices)?t.prices[this.price]:this.price)}},v=function(t){function e(t){r(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=Object.assign({},e.defaultOptions,t.options),s=n.prices,a=void 0===s?m("options.prices"):s,u=Array.isArray(a)?a.length:a,c=360/u,p=1e3/n.fps;return i.direction=n.direction,i.spin=i.spin.bind(i),i.doSpin=i.doSpin.bind(i),i.state={options:n,total:u,fps2ms:p,gap:c},i}return s(e,t),a(e,[{key:"spin",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.options.direction,n=arguments[2],r=this.state,o=r.options,s=r.total,a=r.gap;if(this.deferred=new Promise(function(t,i){e.fulfilled=t,e.rejected=i}),n)this.price=t,this.stop=b.directionMultiplier.call(this,i)*n;else{this.price="number"==typeof t?t:Math.floor(Math.random()*s);var u=(0,h.default)(o.separation,a-o.separation),c="counterclockwise"===this.direction?s-this.price:this.price,p=a*(c-.5),f=p+u,l=(0,h.default)(o.minSpins,o.maxSpins),d=360*l;this.stop=b.directionMultiplier.call(this,i)*(d+f)}return this.prev_angle=this.start_time=0,this.spin_frame=requestAnimationFrame(this.doSpin),this.deferred}},{key:"doSpin",value:function(t){this.start_time=this.start_time||t,this.last_frame_time=this.last_frame_time||t;var e=t-this.start_time,i=t-this.last_frame_time,n=this.state,r=n.options.bezier,o=n.options;if(i<n.fps2ms)return void(this.spin_frame=requestAnimationFrame(this.doSpin));if(this.last_frame_time=t,e<o.duration){var s=e/o.duration,a=f.default.cubicBezier(r.p1x,r.p1y,r.p2x,r.p2y,s);this.angle=a*this.stop,b.rotate.call(this,this.angle,this.direction)}else b.forceEnd.call(this);Math.abs(this.angle)<Math.abs(this.stop)?this.spin_frame=requestAnimationFrame(this.doSpin):this.fulfilled(Array.isArray(o.prices)?o.prices[this.price]:this.price)}},{key:"doRotate",value:function(t){var e=(0,d.matrix3dRotateZ)(t*Math.PI/180);this.setState({wheelMatrix:e})}},{key:"doSpinnerBounce",value:function(t){var e=(0,d.matrix3dRotateZ)(5*t*Math.PI/180);this.setState({spinnerMatrix:e,isBouncing:!0})}},{key:"stopSpinnerBounce",value:function(){var t=(0,d.matrix3dRotateZ)(0);this.setState({spinnerMatrix:t,isBouncing:!1})}},{key:"render",value:function(){var t=this.props.children,e=this.state,i=e.spinnerMatrix,n=e.wheelMatrix,r=e.options,o=r.wheelClassname,s=r.spinnerClassname;return c.default.createElement("div",null,c.default.createElement("div",{className:o,style:(0,d.createTransformFromMatrix3d)(n)}),c.default.createElement("div",{className:s,style:(0,d.createTransformFromMatrix3d)(i)},t||null))}}]),e}(u.Component);v.propTypes={options:u.PropTypes.object.isRequired,children:u.PropTypes.oneOfType([u.PropTypes.string,u.PropTypes.element])},v.defaultOptions={duration:1e3,separation:5,fps:20,minSpins:10,maxSpins:15,direction:y.CLOCKWISE,wheelClassname:"wheel",spinnerClassname:"spinner",bezier:{p1x:.17,p1y:.67,p2x:.12,p2y:.99},separatorThickness:7,onSpinBounce:Function.prototype},e.default=v,e.JFortuneDirection=y}])});